<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<title>Layout</title>
<head th:fragment="head">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-blue-grey.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!--chen them bootstrap-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!--/chen them bootstrap-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <style>
        html, body, h1, h2, h3, h4, h5 {
            font-family: "Open Sans", sans-serif
        }

        .input-icons i {
            position: absolute;
        }

        .input-icons {
            width: 100%;
        }

        .icon {
            padding: 10px;
            min-width: 5px;
        }

        .input-field {
            width: 100%;
            height: 30px;
            padding: 20px;
            text-align: center;
        }

        tr.spaceUnder > td {
            padding-bottom: 1em;
        }

        .postimage {
            padding-left: 75px;
            width: 600px;
            height: 300px;
        }
    </style>
</head>


<body class="w3-theme-l5">

<!-- Navbar -->
<nav th:fragment="menu">
    <div class="w3-top">
        <div class="w3-bar w3-theme-d2 w3-left-align w3-large">
            <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large w3-theme-d2"
               href="javascript:void(0);" onclick="openNav()"><i class="fa fa-bars"></i></a>
            <a href="#" class="w3-bar-item w3-button w3-padding-large w3-theme-d4"><img th:src="@{../logo1.png}" alt=""
                                                                                        width="35px" height="35px"></a>
            <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white"
               title="Friend Requests"><i class="fa fa-user"></i><span
                    class="w3-badge w3-right w3-small w3-green">3</span></a>


            <div class="w3-dropdown-hover w3-hide-small">
<!--            ################################-->
                <button class="w3-button w3-padding-large" title="Notifications"><i class="fa fa-bell"></i><span
                        class="w3-badge w3-right w3-small w3-green"><div id="signalNumber"></div></span></button>
                <div class="w3-dropdown-content w3-card-4 w3-bar-block" style="width:300px">
<!--             #####################-->
                    <div id="friendListRequest"></div>
                </div>
            </div>

            <!--search post-->
            <div class="w3-dropdown-hover w3-hide-small">
                <form>
                    <div style="width: fit-content;margin:auto; height: fit-content">
                        <div class="input-icons">
                            <input class="input-field" type="text" placeholder="Search post" style="font-size: small">
                            <i class="fa fa-search icon fa-lg"></i>
                        </div>
                    </div>
                </form>
            </div>
            <!--search post end-->

            <!--search user-->
            <div class="w3-dropdown-hover w3-hide-small" style="padding-left: 50px">
                <form>
                    <div style="width: fit-content;margin:auto; height: fit-content">
                        <div class="input-icons">
                            <input class="input-field" type="text" placeholder="Search user" style="font-size: small">
                            <i class="fa fa-search icon fa-lg"></i>
                        </div>
                    </div>
                </form>
            </div>
            <!--search user end-->


            <!--logout button-->
            <a href="#" class="w3-bar-item w3-button w3-hide-small w3-right w3-padding-large"
               title="Logout">
                <img src="/img/avatar.jpg" class="w3-circle" style="height:30px;width:30px" alt="Avatar">
            </a>
            <!--logout button end-->

        </div>
    </div>
</nav>
<!--Navbar end-->

<!-- Page Container -->
<div class="w3-container w3-content" style="max-width:1400px;margin-top:80px">
    <!-- The Grid -->
    <div class="w3-row">
        <!-- Left Column -->
        <div th:fragment="leftcolumn" class="w3-col m3">
            <!-- Profile -->
            <div class="w3-card w3-round w3-white">
                <div class="w3-container">
                    <h4 class="w3-center" th:text="${user.userName}"></h4>
                    <p class="w3-center"><img th:src="${'../' + user.getAvatarURL()}" class="w3-circle" style="height:106px;width:106px" alt="Avatar"></p>
                    <hr>
                    <p><i class="fa fa-id-card fa-fw w3-margin-right w3-text-theme"></i><span th:text="${user.firstName} + ' ' + ${user.lastName}"></span></p>
                    <p><i class="fa fa-home fa-fw w3-margin-right w3-text-theme"></i><span th:text="${user.city}"></span></p>
                    <p><i class="fa fa-birthday-cake fa-fw w3-margin-right w3-text-theme"></i><span th:text="${user.dateOfBirth}"></span></p>
                    <p><i class="fa fa-venus-mars fa-fw w3-margin-right w3-text-theme"></i><span th:text="${user.gender}"></span></p>
                    <p><i class="fa fa-mobile fa-fw w3-margin-right w3-text-theme"></i><span th:text="${user.phone}"></span></p>
                    <p><i class="fa fa-user-circle-o fa-fw w3-margin-right w3-text-theme"></i><span th:text="${user.about}"></span></p>
                    <br>
                    <i class="fa fa-pencil fa-fw w3-margin-right w3-text-theme"></i><a th:href="@{/editprofile}">edit</a>
                </div>
            </div>
        </div>
        <!-- Left Column End-->

        <!-- Middle Column -->
        <div class="w3-col m7">
            <div class="w3-row-padding">
                <div class="w3-col m12">
                    <div class="w3-card w3-round w3-white">
                        <div class="w3-container w3-padding">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Middle Column -->

        <!-- Right Column -->
        <div th:fragment="rightcolumn" class="w3-col m2">
            <!--            <script src="../static/js/rightbarfriend.js"></script>-->
            <div class="w3-card w3-round w3-white w3-center">
                <div class="w3-container">
                    <!--search friends-->
                    <div style="width: auto;margin:auto; height: auto">
                        <form th:action="@{/searchfriendbyname}" method="get">
                            <div class="input-icons">
                                <input class="input-field" type="text" placeholder="Search friend" th:name="input">
                                <label for="searchFriend" style="float: left">
                                    <i class="fa fa-search icon fa-lg" style="padding-bottom: 25px"></i>
                                </label>
                                <input type="submit" id="searchFriend" class="hidden">
                            </div>
                        </form>
                    </div>

                    <!--end search friends-->
                    <br>
                    <!--list 5 friends-->
                    <table id="listUserFriend">
                        <script>
                            function loadUserFriend() {
                                $.ajax({
                                    headers: {
                                        'Accept': 'application/json',
                                        'Content-Type': 'application/json'
                                    },
                                    type: 'GET',
                                    url: "/api/getuserfriend/",
                                    success: function (list) {
                                        let content = '';
                                        let length;
                                        if (list.length < 5) {
                                            length = list.length
                                        } else {
                                            length = 5
                                        }
                                        for (let i = 0; i < length; i++) {
                                            content += fillFriendTableRight(list[i]);
                                        }
                                        document.getElementById('listUserFriend').innerHTML = content;

                                        if (document.getElementById("friendListTableMiddle")){
                                            content = '';
                                            for (let i = 0; i < list.length; i++) {
                                                content += fillFriendTableMiddle(list[i]);
                                            }
                                            document.getElementById("friendListTableMiddle").innerHTML = content;
                                        }
                                    }
                                })
                            }

                            function fillFriendTableMiddle(friend) {
                                return `<tr>
                                    <td><img src="${'../' + friend.avatarURL}" alt="Avatar" style="width:50px; height:50px; border-radius: 50%"></td>
                                    <td><a href="${'/show-personal-page/' + friend.userId}" style="padding-left: 10px">${friend.userName}</a></td>
                                    <td><button style="margin-left: 150px" href="${friend.userId}" onclick="removeFriendInList(this)">Unfriend</button></td>
                                </tr>`
                            }

                            function fillFriendTableRight(friend) {
                                return `<tr class="spaceUnder">` +
                                    `<td><img src="${'../' + friend.avatarURL}" alt="" width="30px" height="30px" style="border-radius: 50%">` +
                                    `</td>` +
                                    `<td style="padding-left: 2px"><a href="${'/show-personal-page/' + friend.userId}"><span style="font-size: 13px">${friend.userName}</span></a>` +
                                    `</td>` +
                                    `<td style="padding-left: 5px">` +
                                    `<button style="font-size: xx-small" href="${friend.userId}" onclick="removeFriendInList(this)">Unfriend</button>` +
                                    `</td>` +
                                    `</tr>`
                            }

                            function removeFriendInList(friend) {
                                let idFriend = friend.getAttribute("href");
                                $.ajax({
                                    headers: {
                                        'Accept': 'application/json',
                                        'Content-Type': 'application/json'
                                    },
                                    type: "GET",
                                    url: "/api/removefriend/" + idFriend,
                                    success: function () {
                                        loadUserFriend();
                                    }
                                })
                                event.preventDefault();
                            }
                        </script>
                    </table>
                    <!--list 5 friends end-->
                    <br>
                    <div>
                        <a href="/searchfriendbyname/?input=" style="alignment: right">Go to friend list</a>
                    </div>
                </div>
            </div>
            <br>


            <div class="w3-card w3-round w3-white w3-padding-16 w3-center">
                <p>ADS</p>
            </div>
            <br>

            <div class="w3-card w3-round w3-white w3-padding-32 w3-center">
                <p><i class="fa fa-bug w3-xxlarge"></i></p>
            </div>

            <!-- End Right Column -->
        </div>
        <!-- Right Column End -->


    </div>
</div>
<!-- End Page Container -->
<br>

<!-- Footer -->
<footer th:fragment="footer" class="w3-container w3-theme-d3 w3-padding-16" style="position: fixed; bottom: 0px; width: 100%">
    <h5>C0720I2</h5>
</footer>
<!--Footer end-->

</body>
</html>
